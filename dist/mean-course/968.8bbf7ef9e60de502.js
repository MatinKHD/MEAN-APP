"use strict";(self.webpackChunkmean_course=self.webpackChunkmean_course||[]).push([[968],{7666:(q,v,s)=>{s.r(v),s.d(v,{PostModule:()=>Y});var m=s(6814),u=s(4581),r=s(6223),b=s(4629),t=s(5879),O=s(9862),y=s(5619),h=s(9397),g=s(7398),f=s(8180),T=s(553);let P=(()=>{class i{constructor(){this.http=(0,t.f3M)(O.eN),this.url=T.O.apiUrl+"/posts",this.postsSource=new y.X(null),this.posts=[],this.posts$=this.postsSource.asObservable(),this.setPost=e=>{const n=new FormData;return n.append("title",e.title),n.append("content",e.content),e.image&&n.append("image",e.image,e.title),this.http.post(this.url+"/create",n).pipe((0,h.b)(({post:o})=>{this.posts=[o,...this.posts],this.postsSource.next({posts:this.posts})}))},this.updatePost=(e,n,o,a)=>{let c;return"object"==typeof a?(c=new FormData,c.append("id",e),c.append("title",n),c.append("content",o),c.append("image",a,n)):c={id:e,title:n,content:o,imagePath:a,creator:"",creatorName:"",creatorAvatar:""},this.http.put(this.url+`/${e}`,c).pipe((0,g.U)(p=>p.post))}}fetchPosts(e,n){return this.http.get(this.url).pipe((0,h.b)(({posts:c})=>{this.posts=[...c],this.postsSource.next({posts:this.posts})}),(0,g.U)(({posts:a,maxPosts:c})=>({posts:a,maxPosts:c})))}fetchSinglePost(e){return this.http.get(this.url+`/${e}`).pipe((0,f.q)(1),(0,g.U)(n=>n.post))}deletePost(e){return this.http.delete(this.url+`/${e}`).pipe((0,h.b)(n=>{this.posts=this.posts.filter(o=>o.id!==n.postId),this.postsSource.next({posts:this.posts})}))}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var w=s(9773),S=s(4664),A=s(2096),L=s(8645);let U=(()=>{class i{constructor(){this.unSubscribe$=new L.x}ngOnDestroy(){this.unSubscribe$.next(),this.unSubscribe$.complete()}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac})}return i})();var F=s(4305),C=s(2296),x=s(9157),I=s(2032);function N(i,d){if(1&i&&t._UZ(0,"img",10),2&i){const e=t.oxw();t.Q6J("src",e.imagePreview,t.LSH)}}let M=(()=>{class i extends U{constructor(){super(...arguments),this.postService=(0,t.f3M)(P),this.route=(0,t.f3M)(u.gz),this.router=(0,t.f3M)(u.F0),this.fb=(0,t.f3M)(r.qu),this.mode="create",this.isLoading=!1,this.detectMode=()=>{this.route.paramMap.pipe((0,w.R)(this.unSubscribe$),(0,S.w)(e=>{const n=e.get("id");return e.has("id")&&n?(this.isLoading=!0,this.postService.fetchSinglePost(n)):(0,A.of)({id:"",title:"",content:"",creator:"",creatorName:"",creatorAvatar:"",imagePath:""})})).subscribe(e=>{this.isLoading=!1,console.log(e),e.id?(this.mode="eidt",this.post=e,this.form.setValue({title:e.title,content:e.content,image:e.imagePath}),this.imagePreview=e.imagePath):(this.mode="create",this.post=e)})}}ngOnInit(){this.initializeform(),this.detectMode()}initializeform(){this.form=new r.cw({title:new r.NI("",{validators:[r.kI.required,r.kI.minLength(3)]}),content:new r.NI("",{validators:[r.kI.required]}),image:new r.NI(null,{validators:r.kI.required,asyncValidators:F.z})})}onSavePostHanlder(e){this.isLoading=!0;const n={id:"create"===this.mode?"":e,title:this.form.get("title")?.value,content:this.form.get("content")?.value,image:this.form.get("image")?.value,creator:"",creatorName:"",creatorAvatar:"",imagePath:""};this.form.invalid||("create"===this.mode?this.postService.setPost(n).pipe((0,f.q)(1)).subscribe({error:()=>this.isLoading=!1}):this.postService.updatePost(n.id,n.title,n.content,n.image).pipe((0,f.q)(1)).subscribe(()=>this.isLoading=!1),this.router.navigate(["/list"]),this.form.reset())}onFilePickerHandler(e){const n=e.target.files;if(n&&n.length>0){const o=n[0];this.form.patchValue({image:o});const a=new FileReader;a.onload=()=>this.imagePreview=a.result,a.readAsDataURL(o)}}static#t=this.\u0275fac=function(){let e;return function(o){return(e||(e=t.n5z(i)))(o||i)}}();static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-post-create"]],features:[t.qOj],decls:20,vars:7,consts:[[1,"container"],[3,"formGroup","submit"],["matInput","","type","text","placeholder","Title","formControlName","title"],[1,"image-container"],["class","imagePreview","alt","imagePreview",3,"src",4,"ngIf"],["mat-button","","type","button",3,"click"],["type","file",2,"display","none",3,"change"],["filePicker",""],["matInput","","type","text","placeholder","Content","formControlName","content"],["mat-raised-button","","color","primary","type","submit"],["alt","imagePreview",1,"imagePreview",3,"src"]],template:function(n,o){if(1&n){const a=t.EpF();t.TgZ(0,"div",0)(1,"form",1),t.NdJ("submit",function(){return o.onSavePostHanlder(o.post.id)}),t.TgZ(2,"mat-form-field")(3,"mat-label"),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",2),t.qZA(),t.TgZ(6,"div",3),t.YNc(7,N,1,1,"img",4),t.TgZ(8,"button",5),t.NdJ("click",function(){t.CHM(a);const p=t.MAs(11);return t.KtG(p.click())}),t._uU(9," Select Image "),t.qZA(),t.TgZ(10,"input",6,7),t.NdJ("change",function(p){return o.onFilePickerHandler(p)}),t.qZA()(),t.TgZ(12,"mat-form-field")(13,"mat-label"),t._uU(14,"Content"),t.qZA(),t._UZ(15,"input",8),t.qZA(),t.TgZ(16,"button",9),t._uU(17),t.ALo(18,"uppercase"),t.ALo(19,"uppercase"),t.qZA()()()}2&n&&(t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(6),t.Q6J("ngIf",o.imagePreview),t.xp6(10),t.hij(" ","create"===o.mode?t.lcZ(18,3,"save"):t.lcZ(19,5,"edit")," "))},dependencies:[m.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,C.lW,x.KE,x.hX,I.Nt,m.gd],styles:[".container[_ngcontent-%COMP%]{background-color:#9e9c9c23}form[_ngcontent-%COMP%]{display:flex;flex-flow:column;justify-content:start;align-items:center;margin:10px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:70%}.image-container[_ngcontent-%COMP%]{display:flex;flex-flow:column;justify-content:center;align-items:center;width:70%;height:180px;margin:10px 0;overflow:hidden;border-radius:5px}.image-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px 0}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:130px;border-radius:10px}"]})}return i})();var $=s(2333),J=s(617),l=s(5195);const H=function(i){return["../edit",i]};function _(i,d){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"mat-card-actions")(2,"button",10)(3,"mat-icon",11),t._uU(4,"edit"),t.qZA()(),t.TgZ(5,"button",12),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.onDeletePost(o.id))}),t.TgZ(6,"mat-icon",9),t._uU(7,"delete"),t.qZA()()()()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("routerLink",t.VKq(1,H,e.id))}}function j(i,d){if(1&i){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.showMenu=!o.showMenu)}),t.TgZ(1,"mat-icon"),t._uU(2,"menu"),t.qZA()()}}function k(i,d){if(1&i&&(t.TgZ(0,"mat-card")(1,"mat-card-header"),t._UZ(2,"img",2),t.TgZ(3,"h2"),t._uU(4),t.qZA(),t._UZ(5,"span",3),t.YNc(6,_,8,3,"div",4),t.TgZ(7,"div"),t.YNc(8,j,3,0,"button",5),t.ALo(9,"async"),t.qZA()(),t.TgZ(10,"mat-card-content"),t._UZ(11,"img",6),t.TgZ(12,"mat-card-title"),t._uU(13),t.qZA(),t.TgZ(14,"div",7)(15,"button",8)(16,"mat-icon",9),t._uU(17,"favorite_border"),t.qZA()()(),t.TgZ(18,"p"),t._uU(19),t.qZA()()()),2&i){const e=d.$implicit,n=t.oxw();let o;t.xp6(2),t.Q6J("src",e.creatorAvatar,t.LSH),t.xp6(2),t.Oqu(e.creatorName),t.xp6(2),t.Q6J("ngIf",e.showMenu),t.xp6(2),t.Q6J("ngIf",e.creator===(null==(o=t.lcZ(9,7,n.user$))||null==o.user?null:o.user.id)),t.xp6(3),t.Q6J("src",e.imagePath,t.LSH),t.xp6(2),t.Oqu(e.title),t.xp6(6),t.Oqu(e.content)}}let z=(()=>{class i{constructor(){this.postService=(0,t.f3M)(P),this.authSerive=(0,t.f3M)($.e),this.posts=[],this.isLoading=!1,this.pageSizeOption=[1],this.showMenu=!1}ngOnInit(){this.onFetchedPosts(),this.user$=this.authSerive.user$,this.posts$=this.postService.posts$}onDeletePost(e){this.postService.deletePost(e).subscribe()}onPostMenuClickHandler(e){this.posts.forEach(n=>{}),console.log(this.showMenu)}onFetchedPosts(){this.isLoading=!0,this.postService.fetchPosts(this.postPerPage,1).subscribe(()=>this.isLoading=!1)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-list"]],decls:3,vars:3,consts:[[1,"container"],[4,"ngFor","ngForOf"],["mat-card-avatar","","alt","user-profile",3,"src"],[1,"spacer"],[4,"ngIf"],["class","btn-container","type","button","mat-icon-button","",3,"click",4,"ngIf"],["mat-card-image","","alt","post image",3,"src"],[1,"like","btn-container"],["type","button","mat-icon-button",""],["color","warn"],["mat-icon-button","",3,"routerLink"],["color","primary"],["mat-icon-button","",3,"click"],["type","button","mat-icon-button","",1,"btn-container",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0),t.YNc(1,k,20,9,"mat-card",1),t.ALo(2,"async"),t.qZA()),2&n){let a;t.xp6(1),t.Q6J("ngForOf",null==(a=t.lcZ(2,1,o.posts$))?null:a.posts)}},dependencies:[m.sg,m.O5,u.rH,C.RK,J.Hw,l.a8,l.hq,l.kc,l.dn,l.dk,l.G2,l.n5,m.Ov],styles:[".container[_ngcontent-%COMP%]{max-width:50%!important;margin:0 auto;display:flex;flex-flow:row wrap;justify-content:start;align-items:center;background-color:#c6c6c66a}mat-card[_ngcontent-%COMP%]{flex:1 0 100%;max-width:450px;overflow:hidden;margin:20px auto;border-radius:10px}mat-card-header[_ngcontent-%COMP%]{align-items:center;padding:0}mat-card-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;padding:10px;margin:0}mat-card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{padding:0 20px;margin:0}mat-card-content[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;align-items:center;flex-flow:row wrap}mat-card-content[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{flex:1 0 83%}mat-card-content[_ngcontent-%COMP%]   .like[_ngcontent-%COMP%]{flex:1 0 10%}mat-card-content[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 10px}mat-card-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:350px}mat-card-actions[_ngcontent-%COMP%]{justify-content:end}"]})}return i})();var Z=s(4015);const Q=[{path:"list",component:z},{path:"create",component:M,canActivate:[Z.a]},{path:"edit/:id",component:M,canActivate:[Z.a]}];let Y=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[m.ez,u.Bz.forChild(Q),r.UX,b.h]})}return i})()}}]);